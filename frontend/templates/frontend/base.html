{% load analytical %}
{% load avatar_tags %}
{% load static %}
<!DOCTYPE html>
<html>
  <head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106571309-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-106571309-3');
  </script>

  {% analytical_head_top %}
    <title>{% block head_title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css"
    />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <style>
    </style>
    {% block extra_head %}
    {% endblock %}
    <!-- Facebook Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '731404717277279');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=731404717277279&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->
  {% analytical_head_bottom %}
  </head>
  <body>
  {% analytical_body_top %}
  <script>
    window.dark_theme = false;
    {% if request.user.is_authenticated %}
      window.is_logged_in = true;
      const parser = new DOMParser
      const parse = parser.parseFromString("{% avatar_url user %}", 'text/html')
      const decodedURL = parse.body.textContent;
      window.avatar_url = decodedURL;
      {% if request.user.socialaccount_set.all|length > 0 %}
      window.avatar_url = "{{ request.user.socialaccount_set.first.get_avatar_url|safe }}";
      window.name = "{{ request.user.get_full_name }}";
      {% else %}
      window.name = "{{ request.user.username|title }}";
      {% endif %}
    {% else %}
      window.is_logged_in = false;
  {% endif %}

  </script>
    <div id="header"></div>
    <div class="ui centered grid">
    <div class="row"></div>
    <div class="row"></div>
    {% block pre_body %}
    {% endblock %}
    {% block body %}

    {% block content %}
    {% endblock %}

    <script src="{% static "frontend/main.js" %}"></script>

    {% endblock %}
    {% block extra_body %}
    {% endblock %}
    {% block post_body %}
    {% endblock %}
    </div>
  {% if messages %}
    <div>
      <strong>Messages:</strong>
      <ul>
        {% for message in messages %}
          <li>{{message}}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {% analytical_body_bottom %}
  </body>
</html>
