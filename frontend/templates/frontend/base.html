{% load analytical %}
{% load avatar_tags %}
{% load static %}
<!DOCTYPE html>
<html>
  <head>
  {% analytical_head_top %}
    <title>{% block head_title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" />
    <style>
    </style>
    {% block extra_head %}
    {% endblock %}
  {% analytical_head_bottom %}
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-3183978059906512",
        enable_page_level_ads: true
      });
    </script>
  </head>
  <body>
  {% analytical_body_top %}
  <script>
    window.dark_theme = false;
    {% if request.user.is_authenticated %}
      window.is_logged_in = true;
      const parser = new DOMParser
      const parse = parser.parseFromString("{% avatar_url user %}", 'text/html')
      const decodedURL = parse.body.textContent;
      window.avatar_url = decodedURL;
      {% if request.user.socialaccount_set.all|length > 0 %}
      window.avatar_url = "{{ request.user.socialaccount_set.first.get_avatar_url|safe }}";
      window.name = "{{ request.user.get_full_name }}";
      {% else %}
      window.name = "{{ request.user.username|title }}";
      {% endif %}
    {% else %}
      window.is_logged_in = false;
  {% endif %}

  </script>
    {% block pre_body %}
    {% endblock %}
    {% block body %}

    {% block content %}
    {% endblock %}

    <script src="{% static "frontend/main.js" %}"></script>

    {% endblock %}
    {% block extra_body %}
    {% endblock %}
    {% block post_body %}
    {% endblock %}
    </div>
  {% if messages %}
    <div>
      <strong>Messages:</strong>
      <ul>
        {% for message in messages %}
          <li>{{message}}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {% analytical_body_bottom %}
  </body>
</html>
